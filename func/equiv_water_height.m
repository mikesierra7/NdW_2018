function erg=equiv_water_height(C,S,GC,P,n,lambda,rho_E,rho_w,R)% Berechnung dee Aequivalenten Wasserhoehe aus Kugelfunktionskoeffizienten% Input: C,S  Kugelfunktionskoeffizienten%        GC   Gauss Filter Koeffizienten%        P    normalized Legendre Funktionen%      lambda Geog. Laenge des Berechnugspunktes in Radiant%       rho_E Durchschnittliche Dichte der Erde%       rho_w Durchschnittliche Dichte von Wasser%        R    Radius der Erde% Output  erg EWH%% Berechnet die folgende Formel%            oo             l%      R d  =====         =====%         E \     2 l + 1 \       _                    _                _% h  = ----  >    -------  >    /dC   cos(m lambda) + dS sin(m lambda)\ P  (cos theta)%  w   3 d  /     1 + k   /     \  lm                                 /  lm%         w =====      l  =====%           l = 2         m = 0% % Referenzen:% Wahr, J., Molenaar, M., Bryan, F. (1998): Time variability of the Earth's % gravity field: Hydrological and oceanic effects and their possible detection % using GRACE, J. Geophys. Res., 103(B12), 30205-30229, DOI: 10.1029/98JB02844.persistent kn% Love Zahlenif isempty(kn)  kn=lovenumbers;enderg=0;for L=2:n % Grad  indL=L+1;  fak1=(2*L+1)/(1+kn(indL));  sum1=0;  for M=0:L % Ordnung    indM=M+1;    sum1=sum1+...        ( GC(indL)*C(indL,indM)*cos(M*lambda) + GC(indL)*S(indL,indM)*sin(M*lambda) )*P(indL,indM);  end  erg=erg+fak1*sum1;enderg=R*rho_E/(3*rho_w)*erg;  endfunction ki=lovenumbers% Interpolation der Love Zahlen fuer das PREM Earth Model, nach% Wahr, J. (2007): Time Variable Gravity Fields from Satellites. In: Herring, % T.A. (Ed.): Treatise on Geophysics, Vol 3.kl=[2 -0.3033 -0.1944 -0.1325 -0.1046 -0.0897 -0.0818 -0.0769 -0.07210 -0.06912 -0.064 15 -0.058 20 -0.051 30 -0.040 40 -0.033 50 -0.027 70 -0.020 100 -0.014 150 -0.010200 -0.007];ki=[0 0 interp1(kl(:,1),kl(:,2),2:125,'pchip')]';end